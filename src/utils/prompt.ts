import type { NoteData, ConnectionData } from '../types';

export const generateAnalysisPrompt = (notes: NoteData[], connections: ConnectionData[]): string => {
  const mapData = { notes, connections };
  const mapDataString = JSON.stringify(mapData, null, 2);

  const prompt = `
# 조직 문화 심층 분석 보고서 프롬프트

## 역할
당신은 조직 문화, 변화관리, 행동경제학, 조직개발, 심리학 등 다양한 학문을 융합하여 분석하는 세계 최고 수준의 다학제적 전문가입니다. 당신의 분석은 단순한 현상 나열을 넘어, 복잡한 조직 시스템의 근본적인 동인을 꿰뚫어 보고 실행 가능한 통찰력을 제공해야 합니다.

## 분석 대상 데이터
아래 JSON 데이터는 조직의 '결과', '행동', 그리고 그 원인이 되는 '명시적/암묵적 요인'들과 그들 간의 '연결 관계'를 나타내는 컬처 맵입니다.

\`\`\`json
${mapDataString}
\`\`\`

## 핵심 임무
위 데이터를 기반으로, 다음 3가지 항목으로 구성된 **조직 문화 분석 보고서**를 생성해주세요. 보고서는 반드시 마크다운 형식으로 작성해야 합니다.

### 1. 조직 문화 진단 (정의와 근거)
- **정의:** 이 조직의 문화를 **권위 있는 학자(예: Edgar Schein, Kim Cameron, Robert Quinn, Geert Hofstede 등)의 조직 문화 모델이나 이론에 입각하여 한 문장으로 명확하게 정의**해주세요. (예: "이 조직은 킴 카메룬의 경쟁가치모형(CVM)에 따르면 '위계 문화(Hierarchy Culture)'의 특성이 지배적으로 나타납니다.")
- **핵심 근거:** 위와 같이 정의한 핵심 근거를 맵 데이터에서 3~5가지 찾아 구체적으로 제시해주세요. 단순히 노드를 나열하는 것이 아니라, **연결 관계를 해석하여 "A 요인으로 인해 B 행동이 나타나고, 이는 C라는 결과로 이어진다"는 식의 인과적 서사**로 설명해야 합니다.

### 2. 가장 효과적인 변화의 지렛대 (핵심 레버리지)
- 현재 조직이 더 나은 방향으로 나아가기 위해 **가장 결정적인 변화를 만들 수 있는 '핵심 요인(레버리지 포인트)'을 2~3개만** 선택해주세요.
- 왜 그것이 가장 효과적인지, 다른 요인이 아닌 그것에 집중해야 하는 이유를 시스템적 관점에서 설명해주세요. (예: "A 요인은 다수의 부정적 행동을 유발하는 '병목 현상'의 원인이므로, 이 문제를 해결하면 연쇄적인 긍정 효과를 기대할 수 있습니다.")

### 3. 실효성 높은 솔루션 아이디어
- 위에서 제시한 '핵심 요인'을 개선하거나 강화하기 위한 **구체적이고 실행 가능한 솔루션 아이디어를 3~5가지 제안**해주세요.
- 각 아이디어는 **해당 조직의 리더와 구성원들이 당장 실행해볼 수 있을 정도로** 구체적이어야 합니다. (추상적인 '소통 강화' 대신 '매주 금요일 30분, 리더-구성원 간 1:1 커피챗 진행'과 같이 제안)

## 최종 출력 규칙
- **마크다운 형식:** 반드시 지정된 마크다운 헤더(\`##\`, \`###\`)를 사용하여 구조화된 보고서 형태로 출력해주세요.
- **전문가적 언어:** 아마추어적인 조언이 아닌, 전문가적 식견과 깊이 있는 통찰력이 드러나는 언어를 사용해주세요.
- **설명 금지:** 이 프롬프트 자체에 대한 설명이나 잡담 없이, 바로 '조직 문화 분석 보고서' 본문으로 시작해주세요.
`;
  return prompt.trim();
}; 